.\" Automatically generated by Pandoc 3.8.3
.\"
.TH "zelta\-policy" "8" "" "" "System Manager\(cqs Manual"
.SH NAME
\f[B]zelta policy\f[R] \- execute a list of \f[B]zelta backup\f[R]
operations from a policy configuration
.SH SYNOPSIS
\f[B]zelta policy\f[R] [\f[I]backup\-override\-options\f[R]]
[\f[I]site\f[R]|\f[I]host\f[R]|\f[I]dataset\f[R]] \f[I]\&...\f[R]
.SH DESCRIPTION
\f[B]zelta policy\f[R] reads from a simple YAML\-style configuration
file containing parameters for \f[B]zelta backup\f[R].
Running \f[B]zelta policy\f[R] without parameters will iterate through
the entire configuration file.
Override options for either \f[B]zelta policy\f[R] or \f[B]zelta
backup\f[R] can be provided on the command line, for example, adding
\f[CR]\-\-json\f[R] will cause that parameter to be passed to all
\f[B]zelta backup\f[R] calls.
Subsequent undashed parameters will be matched against a user\-defined
\f[I]site\f[R] name, \f[I]host\f[R] name, or \f[I]dataset\f[R], and the
backup processes will be limited to that group or item.
.SS Options
In the \f[B]zelta policy\f[R] configuration file, you may override
\f[B]zelta backup\f[R]\(cqs default parameters as defined in
\f[B]zelta\-backup(8)\f[R].
For the complete list of Zelta configuration options, see
\f[B]zelta\-options(7)\f[R].
The following parameters are specific \f[B]zelta policy\f[R]:
.TP
\f[B]\-\-retry\f[R]
Retry failed syncs the indicated number of times.
.TP
\f[B]\-\-jobs\f[R]
Run the indicated number of policy jobs concurrently, one for each Site
in the configuration.
.TP
\f[B]\-\-backup\-root\f[R]
The relative target path for the target job.
For example `bkhost:tank/Backups' would place backups below that dataset
(if not overridden).
.TP
\f[B]\-\-host\-prefix\f[R]
Include the source hostname as a parent of the synced target, for
example, `tank/Backups/source.host/backup\-dataset'.
.TP
\f[B]\-\-ds\-prefix\f[R]
Similar to `zfs recv \-d' and `\-e', include the indicated number of
parent labels for the target\(cqs synced name.
See `zelta help backup' for more detail.
.SS Backup Job Parameters
Without additional parameters, \f[B]zelta policy\f[R] will run a
\f[B]zelta backup\f[R] job for each dataset in the configuration file.
Providing one of the following will limit the backup job.
.PP
\f[B]\f[BI]site\f[B]\f[R] Run a backup job only for the \f[I]site\f[R]
listed.
A \f[I]site\f[R] is a user defined top\-level parameter in the
configuration file representing a list of one or more hosts.
.PP
\f[B]\f[BI]host\f[B]\f[R] Run a backup job only for the \f[I]host\f[R]
listed.
Hosts must be accessible via SSH private\-key authentication or
\f[B]localhost\f[R].
.PP
\f[B]\f[BI]dataset\f[B]\f[R] Run a backup job only for the
\f[I]dataset\f[R] listed.
Note this parameter can match the \f[I]source\f[R] \f[B]or\f[R]
\f[I]target\f[R] dataset, e.g., requesting \f[CR]zroot\f[R] would run
the replication for any matching dataset on any host.
.PP
\f[B]\f[BI]host:dataset\f[B]\f[R] Specify a \f[I]source\f[R] or
\f[I]backup\f[R] dataset endpoint, equivalent to the paramemters of
\f[B]zelta backup\f[R].
.SH FILES
For detailed documentation of the \f[B]zelta policy\f[R] configuraiton
see \f[CR]zelta.conf.example\f[R].
.TP
\f[B]/usr/local/etc/zelta/zelta.conf\f[R]
The default configuration file locaiton.
.SH ENVIRONMENT
For detailed documentation of the \f[B]zelta\f[R] environment variables
see \f[CR]zelta help options\f[R].
.SH SEE ALSO
zelta(8), zelta\-clone(8), zelta\-backup(8), zelta\-options(8),
zelta\-match(8), zelta\-revert(8), zelta\-rotate(8), zelta\-sync(8),
ssh(1), zfs(8), zfs\-list(8)
.SH AUTHORS
Daniel J. Bell <\f[I]bellhyve\(atzelta.space\f[R]>
.SH WWW
https://zelta.space
